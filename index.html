<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Festival Wishes — Cards & Videos</title>
<style>
:root{
  --accent:#ff6b35;
  --muted:#6b7280;
  --bg:#fffaf0;
  --card-bg:#fff;
  --radius:12px;
  --shadow:0 8px 24px rgba(17,17,17,0.08);
}
*{box-sizing:border-box;}
body{margin:0;font-family:Inter,sans-serif;background:var(--bg);color:#111;}
header{display:flex;justify-content:space-between;align-items:center;padding:14px 20px;background:var(--accent);color:#fff;}
header h1{margin:0;font-size:20px;}
.container{max-width:1100px;margin:20px auto;padding:0 16px;}
.festival-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:14px;}
.festival-card,.video-card,.card-item{background:var(--card-bg);border-radius:var(--radius);padding:10px;box-shadow:var(--shadow);display:flex;flex-direction:column;gap:6px;}
.festival-card img,.card-item img{width:100%;border-radius:8px;object-fit:cover;}
.video-card video{width:100%;border-radius:8px;}
.card-actions{display:flex;gap:8px;margin-top:6px;flex-wrap:wrap;}
.btn{background:var(--accent);color:#fff;padding:8px 12px;border:none;border-radius:10px;cursor:pointer;font-weight:600;}
.btn.alt{background:#fff;color:#111;border:1px solid rgba(0,0,0,0.1);}
@media(max-width:640px){.festival-grid{grid-template-columns:1fr;}}
</style>
</head>
<body>
<header>
<h1>Festival Wishes</h1>
</header>
<main class="container">
<section id="homePage">
<div id="festivals" class="festival-grid"></div>
</section>
<section id="festivalPage" style="display:none">
<button onclick="goHome()">← Back</button>
<h2 id="festivalTitle"></h2>
<div id="festivalDesc"></div>
<div style="margin:10px 0"><button class="btn" onclick="downloadAllCards()">Download All Cards</button></div>
<h3>Videos</h3>
<div id="videoGrid" class="festival-grid"></div>
<h3>Cards</h3>
<div id="cardGrid" class="festival-grid"></div>
</section>
</main>
<script>
const SITE_URL='https://festivalwishes.github.io/';

const FESTIVALS={
  'Christmas': {id:'christmas', title:'Christmas', description:'Christmas Celebrations', thumbnail:'media/christmas/card-1.jpg'},
  // Add new festivals here
};

function renderFestivals(){
  const festivalsEl=document.getElementById('festivals');
  festivalsEl.innerHTML='';
  Object.keys(FESTIVALS).forEach(name=>{
    const f=FESTIVALS[name];
    const card=document.createElement('div');
    card.className='festival-card';
    card.innerHTML=`
      <img src='${f.thumbnail}' alt='${name}' onerror="this.src='https://via.placeholder.com/400x200?text=No+Image'">
      <h3>${f.title}</h3>
      <p>${f.description}</p>
      <button class='btn' onclick="openFestival('${name}')">Open</button>
    `;
    festivalsEl.appendChild(card);
  });
}

function fetchMedia(festId){
  return fetch(SITE_URL+'media/'+festId+'/').then(r=>r.text()).then(html=>{
    const parser=new DOMParser();
    const doc=parser.parseFromString(html,'text/html');
    const files=Array.from(doc.querySelectorAll('a')).map(a=>a.getAttribute('href'));
    const cards=files.filter(f=>f.startsWith('card-') && f.endsWith('.jpg'));
    const videos=files.filter(f=>f.startsWith('video-') && f.endsWith('.mp4'));
    return {cards,videos};
  }).catch(()=>({cards:[],videos:[]}));
}

async function openFestival(name){
  const f=FESTIVALS[name];
  document.getElementById('homePage').style.display='none';
  document.getElementById('festivalPage').style.display='block';
  document.getElementById('festivalTitle').textContent=name;
  document.getElementById('festivalDesc').textContent=f.description;

  const {cards,videos}=await fetchMedia(f.id);

  const videoGrid=document.getElementById('videoGrid'); videoGrid.innerHTML='';
  videos.forEach(src=>{
    const vcard=document.createElement('div'); vcard.className='video-card';
    vcard.innerHTML=`<video controls src='media/${f.id}/${src}'></video>
      <div class='card-actions'><button class='btn' onclick="downloadFile('media/${f.id}/${src}')">Download</button></div>`;
    videoGrid.appendChild(vcard);
  });

  const cardGrid=document.getElementById('cardGrid'); cardGrid.innerHTML='';
  cards.forEach(src=>{
    const c=document.createElement('div'); c.className='card-item';
    c.innerHTML=`<img src='media/${f.id}/${src}' alt='Card'><div class='card-actions'><button class='btn' onclick="downloadFile('media/${f.id}/${src}')">Download</button></div>`;
    cardGrid.appendChild(c);
  });
}

function goHome(){
  document.getElementById('festivalPage').style.display='none';
  document.getElementById('homePage').style.display='block';
}

function downloadFile(url){
  const a=document.createElement('a'); a.href=url; a.download=url.split('/').pop(); a.click();
}

function downloadAllCards(){
  const cardLinks=document.querySelectorAll('#cardGrid .card-item img');
  if(cardLinks.length===0){alert('No cards available'); return;}
  cardLinks.forEach(img=>downloadFile(img.src));
}

renderFestivals();
</script>
</body>
</html>
